---
version: 2.1

jobs:
  publish-github-release:
    docker:
      - image: cibuilds/github:0.10
    steps:
      - checkout
      - run:
          name: Create Plugins Zip
          command: zip ./artifacts/carbon-plugins.zip ./plugins/*
      - run:
          name: Create Plugins Tarball
          command: tar -zcvf ./artifacts/carbon-plugins.tar.gz ./plugins/*
      # - run:
      #     name: "Publish Release on GitHub"
      #     command: |
      #       ghr -t ${GHI_TOKEN} -u ${CIRCLE_PROJECT_USERNAME} -r ${CIRCLE_PROJECT_REPONAME} -c ${CIRCLE_SHA1} ${CIRCLE_TAG} ./artifacts/
      - run: ls -latr ./artifacts/ # TODO

workflows:
  version: 2

  package_plugins:
    jobs:
      - publish-github-release
          # filters:
          #   branches:
          #     ignore: /.*/
          #   tags:
          #     only: /^v\d+\.\d+\.\d+.*/

